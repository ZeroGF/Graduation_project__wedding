"use strict";require(["/pc/js/config.js"],function(){require(["jquery","cookie","load"],function(o){o.cookie.json=!0;var n=o.cookie("products"),c=o.cookie("total");console.log(n),0!==n.length&&o(".empty").hide();var a="";n.forEach(function(t){a='\n\t\t     <div class="row cart-item">\n\t\t            <span class="pid" style="display:none;">'.concat(t.pid,'</span>\n\t\t\t\t\t<div class="col-md-1">\n\t\t\t\t\t\t<input type="checkbox" class="select" id="check"/><label for="check"></label>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="col-md-2 img-box">\n\t\t\t\t\t\t<a href="#"><img class="img" src="').concat(t.img,'"/></a>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="col-md-1 col-md-offset-">\n\t\t\t\t\t\t<h2 class="name">').concat(t.title,'</h2>\n\t\t\t\t\t\t<p class="size">SIZE: <span>').concat(t.size,'</span></p>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="col-md-2 price-box">\n\t\t\t\t\t\t<p>$ <span class="price">').concat(t.price,'</span></p>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="col-md-2 amount-box">\n\t\t\t\t\t\t<h3>Quantity</h3>\n\t\t\t\t\t\t<p><span class="reduce">-</span><input type="text" name="" class="count" value="').concat(t.amount,'" /><span class="add">+</span></p>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="col-md-2 price-box">\n\t\t\t\t\t\t<p>$ <span class="sum">').concat((t.price*t.amount).toFixed(2),'</span></p>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="col-md-1">\n\t\t\t\t\t\t<p class="del">X</p>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t'),o(".prod-title").after(a)}),o(".cart_wrap > .cart-item").each(function(t,a){o(this).data("item",n[t])}),o(".select_all").click(function(){var t=o(this).prop("checked");o(".select").prop("checked",t),s()});var i=[];function s(){var a=0;o(".select:checked").each(function(){var t=Number(o(this).parents(".cart-item").find(".sum").text());console.log(t),a+=t}),console.log(a),o(".total").text(a.toFixed(2));var t=o(".otherr").text(),e=a+Number(t);console.log(t),console.log(e),o(".total-add").text(e),c.htotal=a,c.ctotal=e,c.post=t,o.cookie.json=!0,o.cookie("total",c,{expires:7,path:"/"})}function p(){var t=o("#province").val();if(console.log(t),-1!=t){var a="http://route.showapi.com/1149-2?showapi_appid=29550&showapi_sign=08402fce064a484baad949d9a18f75e7&parentId="+t;o.ajax({url:a,dataType:"json",success:function(t){var a="<option value='-1'>请选择城市</option>";t.showapi_res_body.data.forEach(function(t){a+='<option value="'.concat(t.id,'">').concat(t.areaName,"</option>")}),o("#city").html(a)}})}}function r(t,a){for(var e=0;e<a.length;e++){if(Number(a[e].pid)===t)return e}return-1}o(".cart-item").on("click",".select",function(){if(o(".select:checked").length!==n.length?o(".select_all").prop("checked",!1):o(".select_all").prop("checked",!0),o(this).prop("checked")){var t=Number(o(this).parents(".cart-item").find(".pid").text()),a=r(t,n),e=r(t,i),c=o(this).parents(".cart-item").find(".sum").text();n[a].sub=Number(c),-1!==a&&-1===e&&i.push(n[a]),o.cookie("pay",i,{expires:7,path:"/"})}s()}),o(".amount-box").on("click",".add,.reduce",function(){var t=r(Number(o(this).parents(".cart-item").find(".pid").text()),n);if(o(this).is(".add"))n[t].amount++;else{if(n[t].amount<=1)return;n[t].amount--}o(this).siblings(".count").val(n[t].amount),o(this).parents(".cart-item").find(".sum").text((n[t].price*n[t].amount).toFixed(2)),o.cookie("products",n,{expires:7,path:"/"}),s()}),o(".cart_wrap").on("blur",".count",function(){console.log("4444");var t=o(this).parents(".cart-item").data("item");t.amount=o(this).val(),o(this).parents(".cart-item").find(".sum").text((t.amount*t.price).toFixed(2)),o.cookie("products",n,{expires:7,path:"/"}),s()}),o(".cart_wrap").on("click",".del",function(){var t=o(this).parents(".cart-item").data("item"),a=o.inArray(t,n);n.splice(a,1),o.cookie("products",n,{expires:7,path:"/"}),o(this).parents(".cart-item").remove(),s()}),s(),o(".down").click(function(){var e;o(".info").slideDown(),e="http://route.showapi.com/1149-1?showapi_appid=29550&showapi_sign=08402fce064a484baad949d9a18f75e7&level=1",o.ajax({type:"get",url:e,dataType:"json",success:function(t){var a="<option value='-1'>请选择省份</option>";t.showapi_res_body.data.forEach(function(t){a+='<option value="'.concat(t.id,'">').concat(t.areaName,"</option>")}),e="http://route.showapi.com/1149-1?showapi_appid=29550&showapi_sign=08402fce064a484baad949d9a18f75e7&level=1&page=2",o.ajax({type:"get",url:e,dataType:"json",success:function(t){t.showapi_res_body.data.forEach(function(t){a+='<option value="'.concat(t.id,'">').concat(t.areaName,"</option>")}),o("#province").html(a),p()}})}})}),o(".up").click(function(){o(".info").slideUp()}),o(".checkout a").click(function(){return 0===o(".select:checked").length?alert("你还没选择需要购买的商品"):location="/pc/html/pay.html",!1}),o("#province").change(function(){p()})})});